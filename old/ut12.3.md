# UT12.3 Comandos de gesti√≥n de cadenas en Linux

## Tuber√≠as y filtros

```tip
Desde la terminal de Linux posible introducir en una misma l√≠nea dos o m√°s comandos separados por el car√°cter **tuber√≠a** o pipe ‚Äò**\|**‚Äô ,conectando la salida est√°ndar de un comando con la entrada est√°ndar de otro.
```

![](media/dd774f513a039dc83449dfcd5a678495.jpeg)

El uso m√°s habitual es filtrar datos utilizando comandos que vamos a ir viendo, y que pueden actuar tanto como comandos como filtros.

    comando1 | comando2 | ‚Ä¶

üí° La salida proporcionada por el comando1 se tomar√° como entrada para el comando2 y as√≠ sucesivamente

![](media/814cb79550188242261a5944d9ac529c.jpeg)

## Comando wc

```tip
El comando **wc** cuenta el n√∫mero de **l√≠neas, palabras y caracteres** de uno o m√°s fichero(s), incluye espacios en blanco y caracteres de salto de l√≠nea.
```

Su sintaxis es la siguiente: 

    wc [par√°metros] [fichero]

Donde sus par√°metros pueden ser:

    -l visualiza el n√∫mero de l√≠neas del fichero.
    -w visualiza el n√∫mero de palabras del fichero.
    -c visualiza el n√∫mero de caracteres del fichero.


![](media/3b813a2e5d9dc087798088fed0a95d7d.png)

## Comandos head y tail

```tip
El comando **head** muestra las 10 **primeras l√≠neas** de un fichero
```

![](media/2d14d3f04c2e01b260c8077608fcac2a.jpeg)

Si queremos especificar las l√≠neas a mostrar lo haremos con *head ‚Äìn n√∫mero*

```tip
El comando **tail** funciona de la misma forma, pero mostrando las 10 **√∫ltimas l√≠neas** de un fichero.
```

## Comando grep

```tip
El comando **grep** permite **buscar** dentro de archivos, directorios o texto las l√≠neas que concuerden con el elemento que especifiquemos (un patr√≥n de b√∫squeda).
El comando grep localiza el patr√≥n  <u>resalt√°ndolo</u> en rojo.
```

La sintaxis b√°sica del comando es la siguiente:

    grep [par√°metros] [patr√≥n_b√∫squeda] [fichero]

Donde par√°metros puede ser:

    -c visualiza el n¬∫ total de l√≠neas donde se localiza el patr√≥n.
    -n Visualiza el n¬∫ de l√≠nea donde aparece el patr√≥n y l√≠nea completa
    -i Elimina la diferencia entre may√∫sculas y min√∫sculas.
    -l Visualiza el nombre de los ficheros donde se localiza el patr√≥n.
    -v Visualiza las l√≠neas del fichero donde **no** aparece el patr√≥n.
    -w obliga a que patr√≥n coincida solamente con palabras completas.
    -E Sirve para indicar que queremos definir una **expresi√≥n regular** de b√∫squeda.

Algunos ejemplos usando el comando **grep**:

```bash
# Buscar la cadena Texto en el fichero texto.txt
grep "Texto" texto.txt
# Visualizar el contenido de texto.txt y buscar la cadena hola
cat texto.txt | grep "hola"
# Cuenta las veces que aparece la cadena "hola" en el fichero log.txt
grep -c "hola" log.txt
# Verificar si un usuario existe en el sistema
grep nombre_usuario /etc/passwd
# Visualizar los archivos con permisos 777 (rwxrwxrwx)
ls ‚Äìl | grep rwxrwxrwx
```

## Expresiones regulares en grep

Se puede usar el comando grep para buscar con un patr√≥n usando lo que se conoce como **expresiones regulares b√°sicas**. Las expresiones regulares est√°n formadas por letras y n√∫meros, as√≠ como por caracteres.

Las <u>expresiones regulares</u> b√°sicas ya vistas incluyen:

| **S√≠mbolo** | **Descripci√≥n**                                      |
|-------------|------------------------------------------------------|
| .\*         | Para representar cero o m√°s caracteres.              |
| . (punto)   | Para representar un solo car√°cter                    |
| [a e i o u] | Para representar algunos caracteres                  |
| [A-Z][0-9]  | Para presentar un rango de caracteres                |
| **\^**      | Para representar el inicio de una l√≠nea de texto |
| **\$**      | Para representar el fin de l√≠nea de texto        |
| **{n,m}**      | Que el car√°cter o conjunto previo aparezca entre n y m veces.  |

Ejemplos de **expresiones regulares b√°sicas** que podemos usar con *grep*: 

- Un signo de intercalaci√≥n (\^) indica el <u>inicio de l√≠nea</u>:
    ```bash
        grep '^b' texto.txt 
    ```

- Un signo de d√≥lar (\$) indica el <u>fin de l√≠nea</u>:

    ```bash
        grep 'a$' texto.txt
    ```

- Para representar un car√°cter se utiliza el **.** y para m√∫ltiples car√°cteres el .\*

    ```bash
        grep ‚ÄìE 'f.cher.' grep 'tex.*' 
    ```

- Para los rangos y caracteres individuales se utilizan los corchetes:

    ```bash
        grep '[A-Z][aeiou]'
    ```

- Que un caracter aparezca entre n y m veces:

    ```bash
        grep -E 'a{3,5}' texto.txt 
    ```

- El car√°cter 'e' aparece una o ninguna vez:

    ```bash
        grep -E 'e+' texto.txt 
    ```

![](media/f788507ecdeb2a7ef3b16e6eeecab0cc.jpeg)

## Comandos sort y uniq

```tip
El comando **sort** se utiliza para ordenar l√≠neas de un fichero o un flujo, puede usarse como comando o como filtro.
```

Puede ordenar alfab√©tica o num√©ricamente, teniendo en cuenta que cada l√≠nea del fichero es un registro compuesto por varios campos, los cuales est√°n separados por un car√°cter denominado separador de campo (tabulador, espacio en blanco‚Ä¶)

Su sintaxis es: 

    sort [par√°metros] [fichero]

![](media/e4ab11230033e4d0273bca733641c184.png)

Donde par√°metros puede ser:

    -n Para ordenaci√≥n num√©rica
    -k Indicando un n¬∫ por qu√© columna ordenar
    -t Para indicar el separador de columnas
    -r Indica ordenaci√≥n inversa
    

üí° Otro comando muy √∫til es **uniq.** Se usa en combinaci√≥n con **sort** para eliminar las l√≠neas que est√°n repetidas, dejando la salida con l√≠neas que no est√°n repetidas. Para que funcione correctamente las l√≠neas o ficheros deben estar ordenados, ya que trabaja con l√≠neas adyacentes.

![](media/547484050c9d23674080db6445943aa6.jpeg)

![](media/0a21ce98ca799c50e508d32ea74fd9cd.jpeg)

## Comando tr

```tip
El comando **tr** permite sustituir unos caracteres por otros dentro de un archivo. Primero especificamos lo que vamos a sustituir y seguidamente lo que lo sustituye.
```

Su sintaxis es:

    tr [par√°metros] caracteres1 [caracteres2]

Donde par√°metros puede ser:

    -d: elimina los caracteres indicados en caracteres1 .
    -s: reemplaza los caracteres repetidos duplicados.
    -c: los caracteres que no est√©n indicados en *caracteres1* los convierte a *caracteres2*.

Algunos ejemplos √∫tiles con **tr**:

```bash
# Eliminar los caracteres emp de la palabra ejemplo
echo ejemplo | tr ‚Äìd emp
# Cambiar las min√∫sculas por may√∫sculas
echo 'Hola Mundo' | tr '[a-z]' '[A-Z]' 
# Suprimir espacios en blanco
echo "Hola que tal?" | tr ‚Äìd ' ' 
# Suprimir espacios en blanco duplicados
echo "     espacio sobra      " | tr ‚Äìs ' '
```

## Comando cut

```tip
El comando **cut** es utilizado para la extracci√≥n de <u>segmentos</u> (o columnas) de las l√≠neas de texto. 
```

Dada una l√≠nea de texto la trocea seg√∫n el <u>separador o delimitador</u> que le indiquemos.


Su sintaxis es:

    cut [par√°metros] [fichero]

Donde par√°metros puede ser:

    -d car√°cter separador o delimitador
    -f rango o columna a extraer
    -c car√°cter a partir del cual cortar

Por ejemplo:

    ```bash
    # Coge las letras de las posiciones 2 a la 4 inclusive (esi)
    echo "mesilla" | cut -c 2-4
    # Cortar la cadena por la letra 'i' devolviendo la segunda parte (lla) 
    echo "mesilla" | cut -di -f2
    ```

Vamos a ver m√°s ejemplos t√≠picos del uso de **cut.** Dado un fichero de texto separado por espacios llamado *listado.txt* con el siguiente contenido:

    2020:Junio:23:Carla:Mart√≠nez:Equipo-de-b√°squet
    2021:Abril:22:Yoel:Alonso:Clases-de-danza
    2019:Febrero:21:Miguel:Molina:Equipo-de-b√°squet
    2022:Enero:22:Noelia:Bernabeu:Equipo-de-b√°squet
    2020:Mayo:11:Alberto:Silvestre:Clases-de-judo


Mostrar la primera columna:

![](media/03cbb65e4999cdb642f0c2fa2704cf5b.jpeg)

Mostrar la primera, cuarta y sexta columna:

![](media/91d35630e8e8a031f5cbef23bd20307d.jpeg)

## Comando sed

El comando sed se utiliza generalmente para sustituir valores por otros, pero tambi√©n para a√±adir o borrar l√≠neas particulares (aunque se pueden usar otros comandos). 
La sintaxis b√°sica para sustituciones de cadenas de textos, que es para lo que m√°s se utiliza este comando, es la siguiente:

    sed "s/<antiguo_texto>/<nuevo_texto>/g"

La **g** final permite realizar una sustituci√≥n en toda la l√≠nea en caso de haya varias coincidencias. Si se utiliza en su lugar un n√∫mero N realizar√° la sustituci√≥n de la n-aparici√≥n del patr√≥n en la l√≠nea y si se indica al principio, el n¬∫ de l√≠nea.

```bash
# Sustituir todas las apariciones de la palabra Windows por Linux del fichero:
sed 's/Windows/Linux/g' fichero.txt
```

El comando sed permite direccionar en qu√© l√≠neas o rango de la entrada se aplica dicho comando. Se puede hacer mediante un n√∫mero especificando el n√∫mero de l√≠nea de la entrada, o especificando una expresi√≥n regular entre caracteres /

```bash
# Actuar sobre la l√≠nea 3 sustituyendo dichas palabras
sed '3 s/Windows/Linux' fichero.txt
# Eliminar las l√≠neas 2 a 7 del fichero
sed '2,7 d' fichero > fichero2
```

Tambi√©n se puede mostrar una l√≠nea/s completa/s usando sed ‚Äìn n¬∫ p

```bash
sed ‚Äìn 3 p
# Para varias l√≠neas
sed ‚Äìn '3p;5p'
```


## Comando awk

```tip
El comando **awk** es una herramienta avanzada de procesamiento de patrones en l√≠neas de texto. 
```

Su utilizaci√≥n est√°ndar es la de filtrar ficheros o salida de comandos de Linux, tratando las l√≠neas para, por ejemplo, mostrar unas determinadas columnas de informaci√≥n.

La sintaxis b√°sica de *awk* es:

    awk [condicion] { comandos }

*awk* es un comando avanzado que se estudiar√° en posteriores a√±os.

```bash
# Mostrar s√≥lo los nombres y los tama√±os de los ficheros:
ls -l | awk '{ print $8 ":" $5 }'

# Mostrar s√≥lo los nombres y tama√±os de ficheros .txt:
ls -l | awk '$8 ~ /\.txt/ { print $8 ":" $5 }'
```


---


Listado de comandos de **gesti√≥n de cadenas** destacados:

| **Comando** | **Acci√≥n**                                             | **Ejemplo**                 |
|-------------|--------------------------------------------------------|-----------------------------|
| **wc**      | contar el n¬∫ de l√≠neas, caracteres y de palabras.      | wc ‚Äìl fichero.txt           |
| **head**    | Visualiza las primeras filas de un fichero             | head -n5 /var/log/dmesg     |
| **tail**    | Visualiza las √∫ltimas filas de un fichero              | tail /var/log/dmesg         |
| **grep**    | buscar un patr√≥n en un fichero.                        | grep javier /etc/passwd     |
| **sort**    | ordenar el contenido de un fichero/listado.            | ls ‚Äìl \| sort               |
| **uniq**    | elimina filas duplicadas.                              | cat fichero \| uniq         |
| **tr**      | sustituir grupos de caracteres por otros indicados.    | tr 'abc' '123'              |
| **cut**     | cortar o extraer elementos de una l√≠nea de un fichero. | cut ‚Äìd ‚Äú:‚Äù -f 2             |
| **awk**     | herramienta de filtrado avanzado de texto              | ls -l \| awk '{print \$8"}' |
