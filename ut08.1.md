# UT8.1 Administraci√≥n de Windows: procesos, servicios y tareas

## Contenido y debate introductorio

<iframe width="560" height="315" src="https://www.youtube.com/embed/FMENyzjejt8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## Administrador de tareas

```note
üí° El **administrador de tareas** es el programa que nos va a permitir gestionar las aplicaciones, procesos, usuarios y servicios que se est√°n ejecutando actualmente en el equipo. Su uso m√°s habitual es para cerrar un programa que no responde y supervisar el **rendimiento** del equipo a trav√©s de la memoria, red y otros recursos.
```

Para iniciar el Administrador de tareas:

-   Presionar *Ctrl+Alt+Supr* y luego en Administrador de tareas o *Ctrl+Shif+Esc*
-   Hacer clic con el bot√≥n secundario en la barra de tareas y, despu√©s en Administrador de tareas.
-   Bot√≥n derecho sobre el icono del bot√≥n inicio.
-   Comando *taskmgr.exe*

> Expandir la informaci√≥n mostrada haciendo clic en <u>m√°s detalles</u>

![](media/620084c8255b980c4999d8c40d7dd1b9.jpeg)

La informaci√≥n mostrada por el administrador de tareas puede ampliarse marcando m√°s columnas de para ver informaci√≥n como el *PID*, Estado... Haciendo clic sobre cada proceso podemos conocer informaci√≥n adicional desde *propiedades.*

A veces algunas partes de Windows no est√°n respondiendo (barra de tareas, explorador..) mientras que otras aplicaciones funcionan bien. El administrador de tareas permite cerrar esos procesos, aunque a veces es suficiente con **reiniciar** la aplicaci√≥n.

Antes de cerrar o reiniciar una aplicaci√≥n o programa se puede utilizar desde la pesta√±a **detalles** la funci√≥n ‚Äú**analizar cadena de espera**

### Rendimiento

La pesta√±a **rendimiento** muestra en tiempo real informaci√≥n sobre el porcentaje de uso a lo largo del tiempo de los componentes internos de hardware clave que utiliza el equipo como la CPU, la memoria, los discos duros, la red o la gr√°fica (GPU)

![](media/d611c2ec84b337c932d9e1209e852a84.jpeg)

El **monitor de recursos** del administrador de tareas se abre desde la pesta√±a **rendimiento**. Esta herramienta avanzada de an√°lisis no s√≥lo proporciona una visi√≥n general los procesos en sino que tiene varias herramientas para supervisar el rendimiento del sistema y c√≥mo se asignan los recursos (*CPU, Memoria, disco, Red, GPU...*).

![](media/1d37de90b71fecde39202b612dbb6331.jpeg)

### Procesos de inicio

Desde la pesta√±a **inicio** del administrador de tareas, al igual que en msconfig, se visualizan la lista de programas que se cargan o inician de forma autom√°tica del usuario actual al inicio de Windows. Se pueden deshabilitar y ver su impacto en tiempo de inicio.

![](media/393045e5ac4995f591c65294150b9ea6.png)

## Servicios

```note
üí° Los servicios son programas que son iniciados por el propio sistema operativo sin que intervenga el usuario y son necesarios para el funcionamiento correcto del SO.
```

Estos programas se inician en cuanto arranca el equipo sin que sea necesario que se valide ning√∫n usuario ejecut√°ndose en segundo plano.

Para acceder a los servicios de Windows se puede hacer desde el *administrador de equipos* en el apartado *Servicios y aplicaciones* o ejecuntado **services.msc**

![](media/5c827b156dea88223c88238d8e4728b4.jpeg)

üí° Desde la pesta√±a **servicios** del administrador de tareas tambi√©n se puede visualizar el listado completo de servicios as√≠ como su estado actual (detenido o en ejecuci√≥n).

![](media/f488bf187c8f4fa622070d700439c2ef.jpeg)

La herramienta de servicios muestra un listado de los procesos junto con su descripci√≥n, el tipo de inicio y otras caracter√≠sticas. Adem√°s de permitir la consulta, tambi√©n se pueden iniciar o desactivar los servicios que se ejecutan en Windows.

Listado de algunos servicios y su funci√≥n en Windows:

-   Servicios de Escritorio remoto - TermService, - SessionEnv, - UmRdpService
-   Registro remoto - RemoteRegistry: Modificar registro a usuarios remotos.
-   Windows Search - WSearch: Indexa los archivos para hacer b√∫squedas con rapidez.
-   Servicio del Reproductor de Windows Media - WMPNetworkSvc: Comparte las bibliotecas del Reproductor de Windows Media con otros dispositivos.
-   Parental Controls - WPCSvc: Control parental.
-   Archivos sin conexi√≥n - CscService: Realiza actividades de mantenimiento en la cach√© de archivos sin conexi√≥n.
-   Agente de Protecci√≥n de acceso a redes - napagent: Administra informaci√≥n de los equipos de una red.
-   Net Logon - Netlogon: Autentica usuarios y servicios.
-   Servicio del iniciador iSCSI de Microsoft ‚Äì MSiSCSI
-   Servicio de compatibilidad con Bluetooth.
-   Servicio de detecci√≥n autom√°tica de proxy web WinHTTP ‚Äì WinHttpAutoProxySvc.
-   Servicio Informe de errores de Windows.

### Tipos de inicio

Los servicios tienen tres **tipos de inicio** configurables en general:

-   **Autom√°tico**: el servicio comienza en el inicio del sistema.
-   **Autom√°tico (en diferido**): el servicio se inicia poco despu√©s de que el sistema haya terminado de arrancar. Esta opci√≥n se introdujo en Windows Vista para reducir el tiempo de arranque del escritorio.
-   **Manual**: el servicio se inicia s√≥lo cuando se le llame expl√≠citamente.
-   **Desactivado**: El servicio est√° deshabilitado. No va a funcionar.

    ![](media/54c8db40261ac0caa8444c361b1a3b73.jpeg)


## Variables de entorno

```note
üí° Una variable es una letra o cadena de caracteres que contiene valores, que pueden variar en cualquier su valor y utilizados por el sistema operativo para determinadas tareas.
```

Una **constante** en cambio es una letra o cadena de caracteres que contiene valores que no pueden variar, es decir que su valor ser√° siempre el mismo.

Ejemplos:

    DATOS= 5 
    PI=3.1416 
    E= 3.81
    DATOS=‚ÄùENTORNO WINDOWS‚Äù 
    USUARIO=‚ÄùJAVIER‚Äù

Los SO Windows definen las variables de entorno siempre en may√∫sculas.

```note
üí° Las variables de entorno son cadenas que contienen informaci√≥n acerca del entorno para el sistema y el usuario que haya iniciado sesi√≥n en ese momento.
```

Las variables de entorno se crean por la necesidad de acceder al contenido de valores din√°micos, distintos en cada sistema, son par√°metros preestablecidos a rutas, valores o aplicaciones que cambian seg√∫n el entorno, equipo o sistema o el usuario que los utilice.

Existen dos tipos de **variables de entorno**:

-   **Variables del sistema**: variables utilizadas de forma global por el sistema operativo y sus componentes.
-   **Variables de usuario**: Entorno personal del usuario actualmente logueado (scripts, ficheros por lotes).

La ruta local del directorio personal ser√° diferente en cada equipo, porque incluye el nombre del usuario que difiere en cada ocasi√≥n.

![](media/a8abde75e3e1d371c052a74a182750b2.jpeg)En el Shell gr√°fico de Windows: *Este equipo (bot√≥n derecho) \> Propiedades \> Configuraci√≥n avanzada del sistema \> Variables de entorno*.

Para visualizar dichas variables desde la consola CMD de Windows se utilizar√° el comando **SET**, el cual tambi√©n podr√° utilizarse para asignar nuevas variables necesarias y que veremos m√°s adelante.

### Variables de entorno en CMD

```tip
Para visualizar las variables de entorno del sistema se utiliza el comando **SET**.
```

Para asignar una nueva variable de entorno se utilizar√°: SET nombrevariable = ‚Äúvalor‚Äù

        C:> SET TIEMPO=60


Para asignar el nombre de una variable mostrando justo antes un mensaje al usuario se utilizar√° **SET /P** nombrevariable = Introduzca el valor:

        C:> Introduzca el valor: _


Para realizar **operaciones aritm√©ticas** se utilizar√° **SET /A**

        C:> SET /A resultado=2+3
        C:> 5


## Comandos de procesos

```tip
Los procesos tambi√©n pueden administrarse tambi√©n desde la consola de Windows. Para ello se utiliza el comando **TASKLIST**
```

Si se usa sin ning√∫n par√°metro muestra una **lista** similar a la que aparece en la pesta√±a *Procesos* del *Administrador de tareas* con el nombre del proceso, el PID y la memoria usada.

![](media/a977195fae3a548873b883a056d1191b.png)

Para **cerrar** un proceso o tarea puede hacerse utilizando el comando **TASKKILL** con la siguiente sintaxis: TASKKILL /PID numeroPID o TASKKILL /IM notepad.exe

        C:> TASKKILL /PID 792 

## Comandos de informaci√≥n

En Windows tenemos disponible un poderoso comando llamado **WMIC** que es otra alternativa para obtener informaci√≥n del equipo y del SO mediante la l√≠nea de comandos. Algunos ejemplos de su utilizaci√≥n:

-   Informaci√≥n sobre la CPU:

        C:> WMIC /output:fichero.txt CPU get /all /format:LIST


-   Informaci√≥n sobre sistema:

        C:> WMIC /output:fichero.txt NICCONFIG get /all /format:LIST

-   Informaci√≥n sobre discos:

        C:> WMIC /output:fichero.txt DISKDRIVE get /all /format:LIST

-   Informaci√≥n sobre todos los programas instalados:

        C:> WMIC PRODUCT GET NAME

## Comandos de servicios 

```tip
Para visualizar el listado de servicios activos desde la consola de comandos se utiliza el comando **NET START\|STOP\|PAUSE**
```

-   Para ver los servicios iniciados en el sistema actualmente:

        NET START

-   Para detener un servicio activo:

        NET STOP nombreservicio

-   Para pausar un servicio:

        NET PAUSE nombreservicio

-   Ver estado de un servicio:

        SC INTERROGATE nombreservicio


## Programaci√≥n de tareas

En todos los sistemas operativos es posible **automatizar** la ejecuci√≥n de determinadas tareas o procedimientos. Esta automatizaci√≥n responde a la necesidad que pueda tener un usuario de realizar peri√≥dicamente alguna acci√≥n, como una copia de archivos, una limpieza de disco, una copia de seguridad, etc.

Para abrir el programador de tareas se puede buscar desde el men√∫ inicio como tal o desde el men√∫ de **herramientas administrativas.**

![](media/b1fb6788f50dca39c889ff7210a19714.jpeg) 

Ver el listado completos de tareas en tu sistema Windows:

![](media/7d51f06d950410050174e1e085ae385e.jpeg)

![](media/639bd6b02ba43aa0da7e0c916b784aa8.png)

### Tareas b√°sicas

Para crear una tarea sencilla se debe hacer clic en **Acci√≥n** y en **Crear tarea b√°sica**.

![](media/38ff26b65eb158eba623f8931269af81.png)

![](media/a0a6ae2b703119bc96510d8f7f138311.png)![](media/80be0b5447924f663eab0360575f8e47.png)

### Tareas avanzadas

La opci√≥n **crear tarea** es m√°s avanzada, no tiene asistente y permite crear la tarea desde el panel de propiedades y cinco pesta√±as para la configuraci√≥n completa de una tarea:

-   General
-   Desencadenador
-   Acciones
-   Condiciones
-   Configuraci√≥n

![](media/b3484b1185c28d5a88a6fbbc802d6bcd.jpeg)

![](media/9532e8be2f433c78b21c543b167bc151.jpeg)

![](media/591684b3e3526cbde0de8c1c2e13f28f.jpeg)


El programador de tareas es m√°s complejo de lo que parece a simple vista ya que hace uso de un concepto denominado **desencadenadores de eventos.**

Un desencadenador es un evento del sistema que al detectarse permite que una tarea sea ejecutada. Algunos de los desencadenadores son:

-   Al iniciar sesi√≥n
-   Al producirse un evento
-   Al bloquear el equipo
-   Al crear o editar una tarea
-   Al iniciar el sistema

Tambi√©n se pueden agregar tareas programadas desde la l√≠nea de comandos CMD si desea incluirlas en una secuencia de comandos mediante el comando **schtasks** junto con los par√°metros para indicar cu√°ndo debe programar la tarea.

Por ejemplo, si quisiera ejecutar "notepad.exe" todos los mi√©rcoles a la 1:00 pm, podr√≠a usar el siguiente comando:

        SCHTASKS /CREATE /TN OPENNOTEPAD /TR NOTEPAD.EXE /SC WEEKLY /D WED /ST 13:00:00
